<!DOCTYPE html>
<html lang="es">
<head>
    <link rel="icon" sizes="64x64" href="checkout.ico">
    <meta charset="UTF-8">
    <title>Checkout - Reigen Soluciones Express</title>
    <style>
        *{margin:0;padding:0;box-sizing:border-box;}
        html,body{height:100%;background:#000;overflow-x:hidden;}
        #bg{position:fixed;top:0;left:0;width:100%;height:100%;pointer-events:none;z-index:1;overflow:hidden;}
        #bg span{position:absolute;color:#999;font-size:36px;font-weight:bold;white-space:nowrap;opacity:0.55;
                 animation:caer linear infinite;user-select:none;}
        @keyframes caer{0%{transform:translateY(-150vh) rotate(var(--r));}100%{transform:translateY(150vh) rotate(var(--r));}}

        .content{position:relative;z-index:10;min-height:100vh;padding:40px 20px;color:#0f0;font-family:"Comic Sans MS",cursive;}
        .container{max-width:1000px;margin:0 auto;}

        h1{font-size:78px;color:#ff0;text-align:center;text-shadow:8px 8px #f00,0 0 40px red;animation:parpadear 1.3s infinite;}
        @keyframes parpadear{0%,100%{opacity:1}50%{opacity:0.3}}
        marquee{font-size:44px;color:#ffff00;text-shadow:6px 6px #ff00ff;font-weight:bold;margin:20px 0;}

        .caja{background:#00008B;border:16px ridge #00ff00;padding:40px;box-shadow:0 0 100px lime;border-radius:20px;}
        .item{background:#001140;border:4px solid #00ffff;padding:18px;margin:12px 0;border-radius:12px;display:flex;justify-content:space-between;align-items:center;font-size:24px;}
        .item button{background:#f00;color:#fff;padding:10px 25px;border:4px outset #f00;font-size:20px;cursor:pointer;}
        .item button:active{border-style:inset;background:#c00;}

        .total{font-size:56px;color:#ffff00;text-shadow:0 0 30px yellow;background:#000;padding:25px;border:10px solid #00ff00;text-align:center;margin:40px 0;}
        .vaciar{background:#f00;color:#fff;padding:20px 50px;border:6px outset #f00;font-size:36px;cursor:pointer;margin:30px auto;display:block;}
        .pagar{background:#00ff00;color:#000;padding:35px 80px;border:12px outset #00ff00;font-size:52px;cursor:pointer;display:block;margin:50px auto;width:90%;box-shadow:0 0 100px lime;}
        .pagar:hover{transform:scale(1.05);box-shadow:0 0 150px yellow;}
        .pagar:active{border-style:inset;background:#00cc00;}
    </style>
    <script>
// === AL HACER CLICK EN "COMPRAR" → GUARDAR GANANCIA REAL ===
function registrarCompra(precio, servicio) {
    const ventas = JSON.parse(localStorage.getItem('ventasReigen') || '[]');
    
    const nuevaVenta = {
        id: Date.now(),
        fecha: new Date().toLocaleDateString('es'),
        hora: new Date().toLocaleTimeString('es', {hour: '2-digit', minute: '2-digit'}),
        servicio: servicio,
        precio: precio,
        total: precio
    };
    
    ventas.push(nuevaVenta);
    localStorage.setItem('ventasReigen', JSON.stringify(ventas));
    
}
</script>
</head>
<body>

<div id="bg"></div>

<!-- REIGEN GRANDE EN ESQUINA -->
<div style="position:fixed;bottom:30px;left:30px;z-index:9999;pointer-events:none;">
    <img src="https://media.tenor.com/x8v1oNUoA6IAAAAC/reigen-salt.gif" width="420">
</div>

<div class="content">
    <div class="container">
        <h1>CHECKOUT FINAL</h1>
        <marquee>EL MAESTRO REIGEN YA ESTÁ CONTANDO TUS BILLETES</marquee>

        <div class="caja">
            <div id="lista-carrito">Cargando tu destino...</div>

            <div class="total">TOTAL A PAGAR: <span id="total-pagar">0</span> ¥</div>

            <input type="text" id="nombre" placeholder="Nombre completo (para el ritual)" style="width:100%;padding:18px;margin:20px 0;font-size:24px;background:#000;color:#0f0;border:8px inset #00ff00;">
            <input type="text" id="telefono" placeholder="Teléfono (Reigen te llamará)" style="width:100%;padding:18px;margin:20px 0;font-size:24px;background:#000;color:#0f0;border:8px inset #00ff00;">
            <input type="text" id="direccion" placeholder="Dirección exacta" style="width:100%;padding:18px;margin:20px 0;font-size:24px;background:#000;color:#0f0;border:8px inset #00ff00;">

            <button class="vaciar" onclick="vaciarCarrito()">VACIAR CARRITO</button>
            <button class="pagar" onclick="pagarTodo()">PAGAR EN EFECTIVO AL MAESTRO</button>
        </div>

        <marquee direction="right" style="color:#ff00ff;text-shadow:6px 6px #0f0;">
            SIN DEVOLUCIONES · RENOVACIÓN DEL SITIO EN <span id="renovacion"></span> · GRACIAS POR TU FE
        </marquee>
    </div>
</div>

<script>
    // Fondo japonés
    const textos = ["霊とか相談所", "霊幻新隆"];
    const bg = document.getElementById('bg');
    for(let i=0;i<110;i++){
        const s=document.createElement('span'); s.textContent=textos[i%2];
        s.style.left=Math.random()*100+'%';
        s.style.setProperty('--r',(Math.random()*60-30)+'deg');
        const d=25+Math.random()*45;
        s.style.animation=`caer ${d}s linear infinite`;
        s.style.animationDelay=-Math.random()*d+'s';
        bg.appendChild(s);
    }

    let carrito = JSON.parse(localStorage.getItem('carritoReigen') || '[]');
    const lista = document.getElementById('lista-carrito');
    const totalSpan = document.getElementById('total-pagar');

    function actualizarCarrito() {
        if (carrito.length === 0) {
            lista.innerHTML = "<div style='text-align:center;color:#f00;font-size:36px;padding:50px;'>TU CARRITO ESTÁ VACÍO<br>¿Los espíritus te robaron el alma y el dinero?</div>";
            totalSpan.textContent = "0";
            return;
        }

        lista.innerHTML = carrito.map((item, i) => `
            <div class="item">
                <div><strong>${item.servicio}</strong><br>${item.precio} ¥</div>
                <button onclick="eliminarItem(${i})">ELIMINAR</button>
            </div>
        `).join('');

        const total = carrito.reduce((sum, item) => sum + parseInt(item.precio.replace(/\D/g,'')), 0);
        totalSpan.textContent = total.toLocaleString();
    }

    function eliminarItem(i) {
        carrito.splice(i, 1);
        localStorage.setItem('carritoReigen', JSON.stringify(carrito));
        actualizarCarrito();
    }

    function vaciarCarrito() {
        if(confirm("¿Seguro? ¡Los espíritus se reirán de ti!")) {
            carrito = [];
            localStorage.setItem('carritoReigen', JSON.stringify(carrito));
            actualizarCarrito();
        }
    }

    function pagarTodo() {
    if(carrito.length === 0) return alert("¡Tu carrito está vacío!");

    const nombre = document.getElementById('nombre').value || "Cliente Anónimo";
    const total = carrito.reduce((s,i)=>s+parseInt(i.precio.replace(/\D/g,'')),0);

    // Registrar cada servicio como una venta individual:
    carrito.forEach(item => {
        registrarCompra(
            parseInt(item.precio.replace(/\D/g,'')), 
            item.servicio
        );
    });

    alert(`¡PAGO CONFIRMADO, ${nombre.toUpperCase()}!\n\n` +
          `Total: ${total.toLocaleString()} ¥ en efectivo\n` +
          `Servicios contratados: ${carrito.length}\n\n` +
          `El Maestro Reigen llegará en las próximas 24-72h con su maletín de sal y su técnica especial.\n\n` +
          `¡LOS ESPÍRITUS YA ESTÁN HUYENDO!\n` +
          `Gracias por confiar en el mayor psíquico del siglo XXI.`);

    // Vaciar carrito tras pago
    localStorage.removeItem('carritoReigen');
    actualizarCarrito();
}


    document.getElementById('renovacion').textContent = new Date().getFullYear() + 1;
    actualizarCarrito();
</script>
</body>
</html>